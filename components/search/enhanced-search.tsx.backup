'use client';

import { useState, useRef, useEffect } from 'react';
import {
  Search,
  MapPin,
  Calendar,
  Users,
  Filter,
  Minus,
  Plus,
  X,
  Home,
  Building,
  Mountain,
  Trees,
  Bed,
  Star,
  DollarSign,
  Wifi,
  Car,
  Coffee,
  Waves,
  UtensilsCrossed,
  Wind,
  Tv,
  Dumbbell,
  Bath,
  Snowflake,
  Flame,
  Utensils,
  WashingMachine,
  Thermometer,
  Laptop,
  Square,
  ChevronUp,
  Sprout,
  BedDouble,
  Shield
} from 'lucide-react';

interface SearchFilters {
  location: string;
  checkIn: string;
  checkOut: string;
  adults: number;
  children: number;
  infants: number;
  propertyType: string;
  priceMin: number;
  priceMax: number;
  bedrooms: number;
  beds: number;
  bathrooms: number;
  maxGuests: number;
  minRating: number;
  amenities: string[];
}

interface EnhancedSearchProps {
  onSearch: (filters: SearchFilters) => void;
  initialFilters?: Partial<SearchFilters>;
}

// --- Reusable Components ---

/**
 * A wrapper for each section of the filter.
 */
const FilterSection = ({ title, children }: { title: string; children: React.ReactNode }) => (
  <div className="py-6 border-b border-gray-200">
    <h2 className="text-xl font-semibold text-gray-900 mb-4">{title}</h2>
    {children}
  </div>
);

/**
 * A custom styled checkbox for amenities.
 */
const AmenityCheckbox = ({
  id,
  label,
  icon,
  checked,
  onChange
}: {
  id: string;
  label: string;
  icon: string;
  checked: boolean;
  onChange: (checked: boolean) => void;
}) => (
  <div>
    <input
      type="checkbox"
      id={id}
      className="sr-only peer"
      checked={checked}
      onChange={(e) => onChange(e.target.checked)}
    />
    <label
      htmlFor={id}
      className={`flex flex-col items-center justify-center w-full p-4 border rounded-lg cursor-pointer transition-colors
                 hover:bg-gray-50 hover:border-gray-400
                 ${checked ? 'border-black bg-gray-50' : 'border-gray-300'}`}
    >
      <span className="text-2xl mb-1">{icon}</span>
      <span className="text-sm font-medium text-gray-800 text-center">
        {label}
      </span>
    </label>
  </div>
);

/**
 * A selectable card for the "Type of place" section.
 */
const PlaceTypeCard = ({
  label,
  icon,
  isSelected,
  onClick
}: {
  label: string;
  icon: string;
  isSelected: boolean;
  onClick: () => void;
}) => (
  <button
    type="button"
    onClick={onClick}
    className={`flex flex-col items-start w-full p-4 border rounded-lg cursor-pointer transition-colors
                ${isSelected
                  ? 'border-black bg-gray-50'
                  : 'border-gray-300 hover:bg-gray-50 hover:border-gray-400'
                }`}
  >
    <span className="text-2xl mb-2">{icon}</span>
    <span className="text-sm font-semibold text-gray-800">{label}</span>
  </button>
);

/**
 * A counter component for rooms and beds.
 */
const RoomCounter = ({
  label,
  value,
  onChange
}: {
  label: string;
  value: number;
  onChange: (value: number) => void;
}) => {
  const increment = () => onChange(value + 1);
  const decrement = () => onChange(value > 0 ? value - 1 : 0);

  return (
    <div className="flex justify-between items-center py-3">
      <span className="text-base text-gray-700">{label}</span>
      <div className="flex items-center gap-3">
        <button
          type="button"
          onClick={decrement}
          disabled={value === 0}
          className="w-8 h-8 flex items-center justify-center border border-gray-400 rounded-full text-gray-600
                     hover:border-black hover:text-black transition
                     disabled:opacity-50 disabled:cursor-not-allowed"
        >
          <Minus size={16} />
        </button>
        <span className="text-base font-medium text-gray-900 w-8 text-center">
          {value === 0 ? 'Any' : value}
        </span>
        <button
          type="button"
          onClick={increment}
          className="w-8 h-8 flex items-center justify-center border border-gray-400 rounded-full text-gray-600
                     hover:border-black hover:text-black transition"
        >
          <Plus size={16} />
        </button>
      </div>
    </div>
  );
};

/**
 * A toggle switch component for top-tier stays.
 */
const TierToggle = ({
  title,
  description,
  enabled,
  onChange
}: {
  title: string;
  description: string;
  enabled: boolean;
  onChange: (enabled: boolean) => void;
}) => (
  <div className="flex justify-between items-center py-3">
    <div>
      <h3 className="text-base font-medium text-gray-900">{title}</h3>
      <p className="text-sm text-gray-500">{description}</p>
    </div>
    <button
      type="button"
      onClick={() => onChange(!enabled)}
      className={`relative inline-flex items-center h-6 w-11 flex-shrink-0 rounded-full cursor-pointer transition-colors duration-200 ease-in-out
                  ${enabled ? 'bg-black' : 'bg-gray-300'}`}
      role="switch"
      aria-checked={enabled}
    >
      <span
        className={`inline-block w-4 h-4 transform bg-white rounded-full shadow-lg transition-transform duration-200 ease-in-out
                    ${enabled ? 'translate-x-6' : 'translate-x-1'}`}
      />
    </button>
  </div>
);

export function EnhancedSearch({ onSearch, initialFilters = {} }: EnhancedSearchProps) {
  const [showGuestSelector, setShowGuestSelector] = useState(false);
  const [showFilterModal, setShowFilterModal] = useState(false);
  const guestSelectorRef = useRef<HTMLDivElement>(null);

  const [filters, setFilters] = useState<SearchFilters>({
    location: '',
    checkIn: '',
    checkOut: '',
    adults: 2,
    children: 0,
    infants: 0,
    propertyType: '',
    priceMin: 0,
    priceMax: 1000,
    bedrooms: 0,
    beds: 0,
    bathrooms: 0,
    maxGuests: 0,
    minRating: 0,
    amenities: [],
    ...initialFilters
  });

  const propertyTypes = [
    { label: 'House', icon: 'ðŸ ' },
    { label: 'Apartment', icon: 'ðŸ¢' },
    { label: 'Villa', icon: 'ðŸ¡' },
    { label: 'Condo', icon: 'ðŸ˜ï¸' },
    { label: 'Townhouse', icon: 'ðŸ˜ï¸' },
    { label: 'Studio', icon: 'ðŸ ' },
    { label: 'Loft', icon: 'ðŸ¢' },
    { label: 'Cabin', icon: 'ðŸ•ï¸' },
    { label: 'Cottage', icon: 'ðŸ¡' },
    { label: 'Hotel Room', icon: 'ðŸ¨' }
  ];

  // Recommended for you section
  const recommendedItems = [
    { id: 'pool', label: 'Pool', icon: 'ðŸŠ' },
    { id: 'washer', label: 'Washer', icon: 'ðŸ§º' },
    { id: 'parking', label: 'Free parking', icon: 'ðŸ…¿ï¸' },
    { id: 'instant_book', label: 'Instant Book', icon: 'âš¡' }
  ];

  // Type of place options
  const placeTypes = [
    { id: 'any', label: 'Any type' },
    { id: 'room', label: 'Room' },
    { id: 'entire_home', label: 'Entire home' }
  ];

  // Amenities section
  const amenities = [
    { id: 'air_conditioning', label: 'Air conditioning', icon: 'â„ï¸' },
    { id: 'wifi', label: 'Wifi', icon: 'ðŸ“¶' },
    { id: 'kitchen', label: 'Kitchen', icon: 'ðŸ³' },
    { id: 'tv', label: 'TV', icon: 'ðŸ“º' },
    { id: 'beachfront', label: 'Beachfront', icon: 'ðŸ–ï¸' },
    { id: 'gym', label: 'Gym', icon: 'ðŸ‹ï¸' }
  ];

  // Booking options
  const bookingOptions = [
    { id: 'instant_book', label: 'Instant Book', icon: 'âš¡' },
    { id: 'self_checkin', label: 'Self check-in', icon: 'ðŸ”‘' },
    { id: 'allows_pets', label: 'Allows pets', icon: 'ðŸ¶' }
  ];

  // Standout stays
  const standoutStays = [
    { id: 'guest_favorite', label: 'Guest favorite', description: 'The most loved homes on Airbnb', icon: 'ðŸ’–' },
    { id: 'luxe', label: 'Luxe', description: 'Luxury homes with elevated design', icon: 'ðŸ ' }
  ];

  // Property types
  const propertyTypesDetailed = [
    { id: 'house', label: 'House', icon: 'ðŸ ' },
    { id: 'apartment', label: 'Apartment', icon: 'ðŸ¢' },
    { id: 'guesthouse', label: 'Guesthouse', icon: 'ðŸ¡' },
    { id: 'hotel', label: 'Hotel', icon: 'ðŸ¨' }
  ];

  // Host languages
  const hostLanguages = [
    'Chinese (Simplified)', 'English', 'French', 'German', 'Italian', 'Japanese',
    'Korean', 'Portuguese', 'Russian', 'Spanish', 'Arabic', 'Catalan',
    'Croatian', 'Czech', 'Danish', 'Dutch'
  ];

  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (guestSelectorRef.current && !guestSelectorRef.current.contains(event.target as Node)) {
        setShowGuestSelector(false);
      }
    };

    document.addEventListener('mousedown', handleClickOutside);
    return () => document.removeEventListener('mousedown', handleClickOutside);
  }, []);

  const updateFilter = (key: keyof SearchFilters, value: any) => {
    setFilters(prev => ({ ...prev, [key]: value }));
  };

  const adjustGuests = (type: 'adults' | 'children' | 'infants', increment: boolean) => {
    setFilters(prev => {
      const newValue = Math.max(0, prev[type] + (increment ? 1 : -1));
      const newFilters = { ...prev, [type]: newValue };

      // Auto-update maxGuests based on adults + children
      if (type === 'adults' || type === 'children') {
        const totalGuests = (type === 'adults' ? newValue : prev.adults) +
                           (type === 'children' ? newValue : prev.children);
        newFilters.maxGuests = totalGuests;
      }

      return newFilters;
    });
  };

  const toggleAmenity = (amenityId: string, checked: boolean) => {
    setFilters(prev => ({
      ...prev,
      amenities: checked
        ? [...prev.amenities, amenityId]
        : prev.amenities.filter(id => id !== amenityId)
    }));
  };

  const handlePriceChange = (field: 'priceMin' | 'priceMax', value: string) => {
    setFilters(prev => ({
      ...prev,
      [field]: parseInt(value) || 0
    }));
  };

  const handlePropertyTypeSelect = (label: string) => {
    const typeMap: { [key: string]: string } = {
      'House': 'house',
      'Apartment': 'apartment',
      'Villa': 'villa',
      'Condo': 'condo',
      'Townhouse': 'townhouse',
      'Studio': 'studio',
      'Loft': 'loft',
      'Cabin': 'cabin',
      'Cottage': 'cottage',
      'Hotel Room': 'hotel_room'
    };

    const selectedType = typeMap[label] || '';
    setFilters(prev => ({
      ...prev,
      propertyType: prev.propertyType === selectedType ? '' : selectedType
    }));
  };

  const handleTierToggle = (rating: number, enabled: boolean) => {
    setFilters(prev => ({
      ...prev,
      minRating: enabled ? rating : 0
    }));
  };

  const getTotalGuests = () => filters.adults + filters.children;

  const getGuestText = () => {
    const total = getTotalGuests();
    if (total === 0) return 'Add guests';
    if (total === 1) return '1 guest';

    let text = `${total} guests`;
    if (filters.infants > 0) {
      text += `, ${filters.infants} infant${filters.infants > 1 ? 's' : ''}`;
    }
    return text;
  };

  const handleSearch = () => {
    console.log('Search button clicked!', filters);
    onSearch(filters);
    setShowFilterModal(false);
  };

  const clearFilters = () => {
    setFilters({
      location: '',
      checkIn: '',
      checkOut: '',
      adults: 2,
      children: 0,
      infants: 0,
      propertyType: '',
      priceMin: 0,
      priceMax: 1000,
      bedrooms: 0,
      beds: 0,
      bathrooms: 0,
      maxGuests: 0,
      minRating: 0,
      amenities: []
    });
  };

  const hasActiveFilters = () => {
    return filters.propertyType !== '' ||
           filters.priceMin > 0 ||
           filters.priceMax < 1000 ||
           filters.bedrooms > 0 ||
           filters.beds > 0 ||
           filters.bathrooms > 0 ||
           filters.maxGuests > 0 ||
           filters.minRating > 0 ||
           filters.amenities.length > 0;
  };

  return (
    <>
      {/* Main Search Bar */}
      <div className="max-w-5xl mx-auto bg-white/10 backdrop-blur-xl rounded-2xl shadow-2xl p-2 border border-white/20">
        <div className="bg-white rounded-xl shadow-xl overflow-hidden">
          <div className="flex flex-col lg:flex-row items-stretch">
            {/* Location */}
            <div className="flex-1 flex items-center px-6 py-5 border-b lg:border-b-0 lg:border-r border-gray-200">
              <MapPin className="w-6 h-6 text-gray-400 mr-4 flex-shrink-0" />
              <div className="flex-1">
                <label className="block text-sm font-semibold text-gray-900 mb-1">Where</label>
                <input
                  type="text"
                  value={filters.location}
                  onChange={(e) => updateFilter('location', e.target.value)}
                  placeholder="Search destinations"
                  className="w-full outline-none text-gray-600 text-sm"
                />
              </div>
            </div>

            {/* Check In */}
            <div className="flex-1 flex items-center px-6 py-5 border-b lg:border-b-0 lg:border-r border-gray-200">
              <Calendar className="w-6 h-6 text-gray-400 mr-4 flex-shrink-0" />
              <div className="flex-1">
                <label className="block text-sm font-semibold text-gray-900 mb-1">Check in</label>
                <input
                  type="date"
                  value={filters.checkIn}
                  onChange={(e) => updateFilter('checkIn', e.target.value)}
                  className="w-full outline-none text-gray-600 text-sm"
                />
              </div>
            </div>

            {/* Check Out */}
            <div className="flex-1 flex items-center px-6 py-5 border-b lg:border-b-0 lg:border-r border-gray-200">
              <Calendar className="w-6 h-6 text-gray-400 mr-4 flex-shrink-0" />
              <div className="flex-1">
                <label className="block text-sm font-semibold text-gray-900 mb-1">Check out</label>
                <input
                  type="date"
                  value={filters.checkOut}
                  onChange={(e) => updateFilter('checkOut', e.target.value)}
                  className="w-full outline-none text-gray-600 text-sm"
                />
              </div>
            </div>

            {/* Guests */}
            <div className="flex-1 relative" ref={guestSelectorRef}>
              <button
                onClick={() => setShowGuestSelector(!showGuestSelector)}
                className="w-full flex items-center px-6 py-5 border-b lg:border-b-0 lg:border-r border-gray-200 hover:bg-gray-50 transition-colors"
              >
                <Users className="w-6 h-6 text-gray-400 mr-4 flex-shrink-0" />
                <div className="flex-1 text-left">
                  <label className="block text-sm font-semibold text-gray-900 mb-1">Who</label>
                  <span className="text-sm text-gray-600">{getGuestText()}</span>
                </div>
              </button>

              {/* Guest Selector Dropdown */}
              {showGuestSelector && (
                <div className="absolute top-full left-0 w-80 bg-white border border-gray-200 rounded-xl shadow-xl z-50 p-6">
                  <div className="space-y-6">
                    {/* Adults */}
                    <div className="flex items-center justify-between">
                      <div>
                        <div className="font-semibold text-gray-900">Adults</div>
                        <div className="text-sm text-gray-500">Ages 13 or above</div>
                      </div>
                      <div className="flex items-center gap-3">
                        <button
                          onClick={() => adjustGuests('adults', false)}
                          disabled={filters.adults <= 1}
                          className="w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:border-gray-400 disabled:opacity-30 disabled:cursor-not-allowed"
                        >
                          <Minus className="w-4 h-4" />
                        </button>
                        <span className="w-8 text-center">{filters.adults}</span>
                        <button
                          onClick={() => adjustGuests('adults', true)}
                          className="w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:border-gray-400"
                        >
                          <Plus className="w-4 h-4" />
                        </button>
                      </div>
                    </div>

                    {/* Children */}
                    <div className="flex items-center justify-between">
                      <div>
                        <div className="font-semibold text-gray-900">Children</div>
                        <div className="text-sm text-gray-500">Ages 2-12</div>
                      </div>
                      <div className="flex items-center gap-3">
                        <button
                          onClick={() => adjustGuests('children', false)}
                          disabled={filters.children <= 0}
                          className="w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:border-gray-400 disabled:opacity-30 disabled:cursor-not-allowed"
                        >
                          <Minus className="w-4 h-4" />
                        </button>
                        <span className="w-8 text-center">{filters.children}</span>
                        <button
                          onClick={() => adjustGuests('children', true)}
                          className="w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:border-gray-400"
                        >
                          <Plus className="w-4 h-4" />
                        </button>
                      </div>
                    </div>

                    {/* Infants */}
                    <div className="flex items-center justify-between">
                      <div>
                        <div className="font-semibold text-gray-900">Infants</div>
                        <div className="text-sm text-gray-500">Under 2</div>
                      </div>
                      <div className="flex items-center gap-3">
                        <button
                          onClick={() => adjustGuests('infants', false)}
                          disabled={filters.infants <= 0}
                          className="w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:border-gray-400 disabled:opacity-30 disabled:cursor-not-allowed"
                        >
                          <Minus className="w-4 h-4" />
                        </button>
                        <span className="w-8 text-center">{filters.infants}</span>
                        <button
                          onClick={() => adjustGuests('infants', true)}
                          className="w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:border-gray-400"
                        >
                          <Plus className="w-4 h-4" />
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              )}
            </div>

            {/* Filters & Search */}
            <div className="flex">
              <button
                type="button"
                onClick={() => {
                  console.log('Filter button clicked!');
                  setShowFilterModal(true);
                }}
                className={`px-6 py-5 border-r border-gray-200 hover:bg-gray-50 transition-colors relative cursor-pointer z-10 touch-manipulation ${
                  hasActiveFilters() ? 'bg-orange-50' : ''
                }`}
                aria-label="Open filters"
              >
                <Filter className="w-6 h-6 text-gray-600 pointer-events-none" />
                {hasActiveFilters() && (
                  <div className="absolute top-2 right-2 w-2 h-2 bg-orange-500 rounded-full pointer-events-none" />
                )}
              </button>
              <button
                type="button"
                onClick={handleSearch}
                className="bg-gradient-to-r from-pink-500 to-rose-500 text-white px-8 py-5 lg:rounded-r-xl hover:from-pink-600 hover:to-rose-600 transition-all transform hover:scale-105 font-semibold flex items-center justify-center gap-2 cursor-pointer z-10 touch-manipulation"
                aria-label="Search"
              >
                <Search className="w-5 h-5 pointer-events-none" />
                <span className="hidden sm:inline pointer-events-none">Search</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      {/* Enhanced Filter Modal */}
      {showFilterModal && (
        <div
          className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
          onClick={() => setShowFilterModal(false)}
        >
          <div
            className="bg-white rounded-2xl max-w-2xl w-full shadow-xl overflow-hidden"
            onClick={(e) => e.stopPropagation()}
          >
            {/* Header */}
            <div className="px-6 py-4 border-b border-gray-200 flex items-center justify-between">
              <button
                onClick={() => setShowFilterModal(false)}
                className="w-8 h-8 rounded-full hover:bg-gray-100 flex items-center justify-center"
              >
                <X className="w-4 h-4" />
              </button>
              <h1 className="text-lg font-semibold text-gray-900">
                Filters
              </h1>
              <div className="w-8 h-8"></div>
            </div>

            {/* Scrollable Filter Content */}
            <div className="max-h-[80vh] overflow-y-auto">
              {/* Recommended for you */}
              <div className="px-6 py-6 border-b border-gray-200">
                <h2 className="text-lg font-semibold text-gray-900 mb-4">Recommended for you</h2>
                <div className="grid grid-cols-4 gap-3">
                  {recommendedItems.map((item) => (
                    <button
                      key={item.id}
                      onClick={() => toggleAmenity(item.id, !filters.amenities.includes(item.id))}
                      className={`flex flex-col items-center p-4 border rounded-lg transition-colors ${
                        filters.amenities.includes(item.id)
                          ? 'border-black bg-gray-50 text-gray-900'
                          : 'border-gray-300 hover:border-gray-400 text-gray-900'
                      }`}
                    >
                      <span className="text-2xl mb-1">{item.icon}</span>
                      <span className="text-xs text-center font-medium">{item.label}</span>
                    </button>
                  ))}
                </div>
              </div>

              {/* Type of place */}
              <div className="px-6 py-6 border-b border-gray-200">
                <h2 className="text-lg font-semibold text-gray-900 mb-4">Type of place</h2>
                <div className="grid grid-cols-3 gap-3">
                  {placeTypes.map((type) => (
                    <button
                      key={type.id}
                      onClick={() => updateFilter('propertyType', type.id)}
                      className={`px-4 py-3 border rounded-lg text-sm font-medium transition-colors text-gray-900 ${
                        filters.propertyType === type.id
                          ? 'border-black bg-gray-50'
                          : 'border-gray-300 hover:border-gray-400'
                      }`}
                    >
                      {type.label}
                    </button>
                  ))}
                </div>
              </div>

              {/* Price range */}
              <div className="px-6 py-6 border-b border-gray-200">
                <h2 className="text-lg font-semibold text-gray-900 mb-2">Price range</h2>
                <p className="text-sm text-gray-500 mb-4">Trip price, includes all fees</p>

                {/* Price histogram placeholder */}
                <div className="h-16 mb-4 flex items-end justify-center space-x-1">
                  {Array.from({ length: 20 }, (_, i) => (
                    <div
                      key={i}
                      className={`w-3 bg-red-400 rounded-t ${
                        i < 8 || i > 15 ? 'opacity-30' : ''
                      }`}
                      style={{ height: `${Math.random() * 40 + 20}px` }}
                    />
                  ))}
                </div>

                <div className="flex items-center gap-4">
                  <div className="flex-1">
                    <label className="block text-xs font-medium text-gray-500 mb-1">Minimum</label>
                    <div className="relative">
                      <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">$</span>
                      <input
                        type="number"
                        value={filters.priceMin}
                        onChange={(e) => handlePriceChange('priceMin', e.target.value)}
                        className="w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-200 focus:border-gray-400"
                        placeholder="20"
                      />
                    </div>
                  </div>
                  <div className="w-4 h-px bg-gray-300 mt-6"></div>
                  <div className="flex-1">
                    <label className="block text-xs font-medium text-gray-500 mb-1">Maximum</label>
                    <div className="relative">
                      <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">$</span>
                      <input
                        type="number"
                        value={filters.priceMax}
                        onChange={(e) => handlePriceChange('priceMax', e.target.value)}
                        className="w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-200 focus:border-gray-400"
                        placeholder="1000+"
                      />
                    </div>
                  </div>
                </div>
              </div>

              {/* Rooms and beds */}
              <div className="px-6 py-6 border-b border-gray-200">
                <h2 className="text-lg font-semibold text-gray-900 mb-4">Rooms and beds</h2>
                <div className="space-y-4">
                  <RoomCounter
                    label="Bedrooms"
                    value={filters.bedrooms}
                    onChange={(value) => updateFilter('bedrooms', value)}
                  />
                  <RoomCounter
                    label="Beds"
                    value={filters.beds}
                    onChange={(value) => updateFilter('beds', value)}
                  />
                  <RoomCounter
                    label="Bathrooms"
                    value={filters.bathrooms}
                    onChange={(value) => updateFilter('bathrooms', value)}
                  />
                </div>
              </div>

              {/* Amenities */}
              <div className="px-6 py-6 border-b border-gray-200">
                <h2 className="text-lg font-semibold text-gray-900 mb-4">Amenities</h2>
                <div className="grid grid-cols-2 gap-3">
                  {amenities.map((amenity) => (
                    <button
                      key={amenity.id}
                      onClick={() => toggleAmenity(amenity.id, !filters.amenities.includes(amenity.id))}
                      className={`flex items-center p-3 border rounded-lg transition-colors text-gray-900 ${
                        filters.amenities.includes(amenity.id)
                          ? 'border-black bg-gray-50'
                          : 'border-gray-300 hover:border-gray-400'
                      }`}
                    >
                      <span className="text-lg mr-3">{amenity.icon}</span>
                      <span className="text-sm font-medium">{amenity.label}</span>
                    </button>
                  ))}
                </div>
                <button className="mt-4 text-sm font-medium text-gray-900 underline">
                  Show more
                </button>
              </div>

              {/* Booking options */}
              <div className="px-6 py-6 border-b border-gray-200">
                <h2 className="text-lg font-semibold text-gray-900 mb-4">Booking options</h2>
                <div className="grid grid-cols-3 gap-3">
                  {bookingOptions.map((option) => (
                    <button
                      key={option.id}
                      onClick={() => toggleAmenity(option.id, !filters.amenities.includes(option.id))}
                      className={`flex flex-col items-center p-4 border rounded-lg transition-colors text-gray-900 ${
                        filters.amenities.includes(option.id)
                          ? 'border-black bg-gray-50'
                          : 'border-gray-300 hover:border-gray-400'
                      }`}
                    >
                      <span className="text-lg mb-1">{option.icon}</span>
                      <span className="text-xs text-center font-medium">{option.label}</span>
                    </button>
                  ))}
                </div>
              </div>

              {/* Standout stays */}
              <div className="px-6 py-6 border-b border-gray-200">
                <h2 className="text-lg font-semibold text-gray-900 mb-4">Standout stays</h2>
                <div className="grid grid-cols-2 gap-3">
                  {standoutStays.map((stay) => (
                    <button
                      key={stay.id}
                      onClick={() => toggleAmenity(stay.id, !filters.amenities.includes(stay.id))}
                      className={`flex items-start p-4 border rounded-lg transition-colors text-left text-gray-900 ${
                        filters.amenities.includes(stay.id)
                          ? 'border-black bg-gray-50'
                          : 'border-gray-300 hover:border-gray-400'
                      }`}
                    >
                      <span className="text-xl mr-3 mt-1">{stay.icon}</span>
                      <div>
                        <div className="font-medium text-sm">{stay.label}</div>
                        <div className="text-xs text-gray-500 mt-1">{stay.description}</div>
                      </div>
                    </button>
                  ))}
                </div>
              </div>

              {/* Property type */}
              <div className="px-6 py-6 border-b border-gray-200">
                <h2 className="text-lg font-semibold text-gray-900 mb-4">Property type</h2>
                <div className="grid grid-cols-4 gap-3">
                  {propertyTypesDetailed.map((type) => (
                    <button
                      key={type.id}
                      onClick={() => updateFilter('propertyType', type.id)}
                      className={`flex flex-col items-center p-4 border rounded-lg transition-colors text-gray-900 ${
                        filters.propertyType === type.id
                          ? 'border-black bg-gray-50'
                          : 'border-gray-300 hover:border-gray-400'
                      }`}
                    >
                      <span className="text-2xl mb-2">{type.icon}</span>
                      <span className="text-xs text-center font-medium">{type.label}</span>
                    </button>
                  ))}
                </div>
              </div>

              {/* Accessibility features */}
              <div className="px-6 py-6 border-b border-gray-200">
                <h2 className="text-lg font-semibold text-gray-900 mb-4">Accessibility features</h2>
                <div className="space-y-4">
                  <div>
                    <h3 className="font-medium text-sm mb-3">Guest entrance and parking</h3>
                    <div className="space-y-2">
                      <label className="flex items-center">
                        <input type="checkbox" className="mr-3 rounded" />
                        <span className="text-sm">Step-free access</span>
                      </label>
                      <label className="flex items-center">
                        <input type="checkbox" className="mr-3 rounded" />
                        <span className="text-sm">Disabled parking spot</span>
                      </label>
                      <label className="flex items-center">
                        <input type="checkbox" className="mr-3 rounded" />
                        <span className="text-sm">Guest entrance wider than 32 inches</span>
                      </label>
                    </div>
                  </div>
                  <div>
                    <h3 className="font-medium text-sm mb-3">Bedroom</h3>
                    <div className="space-y-2">
                      <label className="flex items-center">
                        <input type="checkbox" className="mr-3 rounded" />
                        <span className="text-sm">Step-free bedroom access</span>
                      </label>
                      <label className="flex items-center">
                        <input type="checkbox" className="mr-3 rounded" />
                        <span className="text-sm">Bedroom entrance wider than 32 inches</span>
                      </label>
                    </div>
                  </div>
                  <div>
                    <h3 className="font-medium text-sm mb-3">Bathroom</h3>
                    <div className="space-y-2">
                      <label className="flex items-center">
                        <input type="checkbox" className="mr-3 rounded" />
                        <span className="text-sm">Step-free bathroom access</span>
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              {/* Host language */}
              <div className="px-6 py-6">
                <h2 className="text-lg font-semibold text-gray-900 mb-4">Host language</h2>
                <div className="grid grid-cols-2 gap-3">
                  {hostLanguages.map((language) => (
                    <label key={language} className="flex items-center">
                      <input
                        type="checkbox"
                        className="mr-3 rounded"
                        onChange={(e) => {
                          // Handle language selection
                        }}
                      />
                      <span className="text-sm">{language}</span>
                    </label>
                  ))}
                </div>
              </div>
            </div>

            {/* Footer */}
            <div className="px-6 py-4 border-t border-gray-200 flex justify-between items-center bg-gray-50">
              <button
                type="button"
                onClick={clearFilters}
                className="text-sm font-medium underline hover:text-gray-700 text-gray-900"
              >
                Clear all
              </button>
              <button
                type="button"
                onClick={handleSearch}
                className="px-6 py-3 bg-black text-white rounded-lg font-medium hover:bg-gray-800 transition-colors"
              >
                Show 1,000+ homes
              </button>
            </div>
          </div>
        </div>
      )}
    </>
  );
}